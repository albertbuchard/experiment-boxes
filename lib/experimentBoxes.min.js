!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e(require("jQuery"),require(void 0),require(void 0),require(void 0)):"function"==typeof define&&define.amd?define("experimentBoxes",["jQuery","chartjs","lodash","mathjs"],e):"object"==typeof exports?exports.experimentBoxes=e(require("jQuery"),require("chartjs"),require("lodash"),require("mathjs")):t.experimentBoxes=e(t.jQuery,t.Chart,t._,t.math)}(this,function(t,e,n,o){return function(t){function e(o){if(n[o])return n[o].exports;var i=n[o]={i:o,l:!1,exports:{}};return t[o].call(i.exports,i,i.exports,e),i.l=!0,i.exports}var n={};return e.m=t,e.c=n,e.i=function(t){return t},e.d=function(t,n,o){e.o(t,n)||Object.defineProperty(t,n,{configurable:!1,enumerable:!0,get:o})},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=13)}([function(e,n){e.exports=t},function(t,e,n){"use strict";function o(t){return t&&t.__esModule?t:{default:t}}function i(){}function r(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";throw new Error("Missing parameter "+t)}function a(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];for(var o=0;o<e.length;o++)if(void 0===e[o])throw new Error("Argument "+o+" is undefined.");return!0}function s(t){for(var e=arguments.length,n=Array(e>1?e-1:0),o=1;o<e;o++)n[o-1]=arguments[o];if(n.allHaveConstructor(t)===!1)throw new Error("Wrong constructor in arguments.");return!0}function l(t){return t&&"function"==typeof t.then&&"function"==typeof t.catch}function u(t){return new Promise(function(e){setTimeout(e,t)})}function d(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:r(),e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:r();return new Promise(function(n){var o=x.default.random(t,e);setTimeout(n,o)})}function c(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:r(),e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:r(),n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[];return 0===e?new Promise(function(t){t(i)}):t.apply(n,o).then(function(r){return i=i.concat(r),c(t,e-1,n,o,i)})}function f(){var t=this;this.resolve=null,this.reject=null,this.promise=new Promise(function(e,n){t.resolve=e,t.reject=n}),Object.freeze(this)}function h(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:r(),e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:r(),n=[];if("function"==typeof t)for(var o=0;o<e;o++)n=n.concat(t(o));else for(var i=0;i<e;i++)n=n.concat(t);return n}function b(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:r(),e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(t.constructor!==Array)throw new Error("samplePermutation: sequence needs to be an array.");null===n&&(n=t.length);for(var o=t.slice(0),i=[],a=void 0;e&&i.length<n||!e&&o.length;){var s=Math.floor(Math.random()*o.length);a=e?o[s]:o.splice(s,1),i=i.concat(a)}return i}function p(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:r(),e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:r(),n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=[],i=0;i<t;i++){o[i]=[];for(var a=0;a<e;a++)o[i][a]=n}return o}function y(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:r(),e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:r();t=_.default.matrix(t);var n=t.size()[0];return _.default.subset(t,_.default.index(e,_.default.range(0,n)))}function v(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:r(),e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;t=_.default.matrix(t);var n=t.size()[0];null===e&&(e=_.default.range(0,n-1)),e.constructor!==Array&&(e=[e]);for(var o=[],i=0;i<e.length;i++)o.push(_.default.sum(y(t,e[i])));return o}function g(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:r(),e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=t.length,o=[],i=0;i<n;i++)e&&(t[i][i]=e),o.push(t[i][i]);return[o,t]}function m(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:r(),e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:r(),n=[],o=0;o<e.length;o++)e.substr(o,t.length)===t&&n.push(o);return n.length?n:-1}Object.defineProperty(e,"__esModule",{value:!0}),e.findAllIndices=e.noop=e.debugError=e.debugWarn=e.debuglog=e.mandatory=e.mustBeDefined=e.mustHaveConstructor=e.looksLikeAPromise=e.delay=e.jitter=e.recurse=e.Deferred=e.rep=e.samplePermutation=e.matrix=e.getRow=e.rowSum=e.diag=void 0;var w=n(11),x=o(w),E=n(12),_=o(E),T=n(8),k=T.DEBUG_MODE_ON?console.log.bind(console):i,O=T.DEBUG_MODE_ON?console.warn.bind(console):i,S=T.DEBUG_MODE_ON?console.error.bind(console):i;e.diag=g,e.rowSum=v,e.getRow=y,e.matrix=p,e.samplePermutation=b,e.rep=h,e.Deferred=f,e.recurse=c,e.jitter=d,e.delay=u,e.looksLikeAPromise=l,e.mustHaveConstructor=s,e.mustBeDefined=a,e.mandatory=r,e.debuglog=k,e.debugWarn=O,e.debugError=S,e.noop=i,e.findAllIndices=m},function(t,e,n){"use strict";(function(t){function o(t){return t&&t.__esModule?t:{default:t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),a=n(0),s=o(a),l=n(1),u=function(){function e(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;i(this,e),"undefined"==typeof window&&(t.window={}),this.MAX_BINDED_PROPERTIES=15,this.INIT_WIDTH=o||400,this.INIT_HEIGHT=r||300,this.TITLE_HEIGHT=36,this.FOOTER_HEIGHT=34,this.DEFAULT_BOX_THEME="dragbox-gray",this.DEFAULT_DRAGGABLE=!0,this.DEFAULT_STICKINESS_TYPE="magnetized",this.boxId=null,this.boxElement=n,this.draggable=this.DEFAULT_DRAGGABLE,this.boxHTML=null,this.shouldStick=null,this.shouldMagnetize=null,this.isStickingX=null,this.isStickingY=null,this.stickiness=this.DEFAULT_STICKINESS_TYPE,this._beingDragged=!1,this._visibility="hidden",this._overflow="hidden",this._boxClass=this.DEFAULT_BOX_THEME,this._width=this.INIT_WIDTH,this._height=this.INIT_HEIGHT,this.map=[],this.currentMousePos={x:-1,y:-1};var a=this;(0,s.default)(document).mousemove(function(t){a.currentMousePos.x=t.pageX,a.currentMousePos.y=t.pageY}),this.boxElement?this.boxId=(0,s.default)(this.boxElement).attr("id"):(this.boxId="dragbox"+((0,s.default)('div[id*="dragbox"]').length+1),this.boxHTML='<div id="'+this.boxId+'" class="dragbox '+this._boxClass+'" style="display:none;" draggable="false">\n          <div class="col-xs-12 dragbox-container">\n            <div class="col-xs-12 dragbox-title"><center><h3>Dragbox</h3></center>\n          </div>\n          <div class="col-xs-12 dragbox-content"></div>\n          <div class="col-xs-12 dragbox-footer"></div>\n        </div>',(0,s.default)(document.body).append(this.boxHTML),this.boxElement=(0,s.default)("#"+this.boxId)),this.boxClass=(0,s.default)(this.boxElement).attr("class"),this.width=this._width,this.height=this._height,this.overflow="hidden",(0,s.default)(document.body).keydown(function(t){a.keyfunction(t)}),(0,s.default)(document.body).keyup(function(t){a.keyfunction(t)}),(0,s.default)(this.boxElement).click(function(){(0,s.default)(".dragbox").css("zIndex",10),(0,s.default)(a.boxElement).css("zIndex",100)}),(0,s.default)(this.boxElement).find(".dragbox-title").mousedown(function(t){a.startDrag(t)}),(0,s.default)(this.boxElement).find(".dragbox-title").mouseup(function(t){a.stopDrag(t)}),(0,s.default)(document).click(function(t){a.stopDrag(t)}),this.queryString=e.getQueryString()}return r(e,[{key:"destroy",value:function(){var t=this;(0,s.default)(this.boxElement).animate({opacity:0},25,function(){(0,s.default)(t.boxElement).remove()})}},{key:"updateSize",value:function(){(0,s.default)(this.boxElement).width(this.width),(0,s.default)(this.boxElement).height(this.height);var t=this.height-this.TITLE_HEIGHT-this.FOOTER_HEIGHT-7,e=this;(0,s.default)(this.boxElement).animate({height:e.height,width:e.width},25,function(){}),(0,s.default)(this.boxElement).find(".dragbox-container").animate({height:e.height},25,function(){}),(0,s.default)(this.boxElement).find(".dragbox-content").animate({height:t},25,function(){})}},{key:"startDrag",value:function(t){if(t.preventDefault(),this.beingDragged)return this.beingDragged=!1,null;if(!this.draggable)return null;var e={x:t.clientX-(0,s.default)(this.boxElement).offset().left,y:t.clientY-(0,s.default)(this.boxElement).offset().top};return this.beingDragged=!0,this.loopDrag(e),!1}},{key:"stopDrag",value:function(){this.beingDragged=!1}},{key:"loopDrag",value:function(t){if(this.beingDragged===!0){var n=this.currentMousePos.x-t.x,o=this.currentMousePos.y-t.y,i={offsetLeft:n,offsetTop:o,offsetWidth:(0,s.default)(this.boxElement).width(),offsetHeigth:(0,s.default)(this.boxElement).height()},r=e.stayInWindow(i),a=r.x,l=r.y;this.shouldStick&&(r.stickyX!==-2&&2!==r.stickyX||(this.isStickingX=!0),this.isStickingX&&0!==r.stickyX&&(a=r.leftSticky),0===r.stickyX&&(this.isStickingX=!1),r.stickyY!==-2&&2!==r.stickyY||(this.isStickingY=!0),this.isStickingY&&0!==r.stickyY&&(l=r.topSticky),0===r.stickyY&&(this.isStickingY=!1)),this.shouldMagnetize&&(a=r.leftSticky,l=r.topSticky);var u=this;(0,s.default)(this.boxElement).animate({left:a,top:l},25,function(){u.loopDrag(t)})}}},{key:"keyfunction",value:function(){(0,l.debuglog)("dragbox: keyfunction() called.",this)}},{key:"toggle",value:function(){"hidden"===this.visibility?this.visibility="visible":this.visibility="hidden"}},{key:"show",value:function(){this.visibility="visible"}},{key:"hide",value:function(){this.visibility="hidden"}},{key:"append",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:".dragbox-content",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this.boxElement&&(null!==n&&(t='<div class="'+n+'" >'+t+"</div>"),"container"!==e?this.boxElement.find(e).append(t):this.boxElement.append(t))}},{key:"html",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:".dragbox-content",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(this.boxElement){var n="container"!==t?this.boxElement.find(t):this.boxElement;return null!==e?(n.html(e),e):n.html()}return null}},{key:"width",set:function(t){this._width=t,this.updateSize()},get:function(){return this._width}},{key:"height",set:function(t){this._height=t,this.updateSize()},get:function(){return this._height}},{key:"beingDragged",set:function(t){this._beingDragged=t,(0,s.default)(this.boxElement).attr("beingDragged",t)},get:function(){return this._beingDragged}},{key:"boxClass",set:function(t){if(this.boxElement){if("string"!=typeof t)throw new Error("newClass must be a string");this.boxElement.removeClass(this.boxClass).addClass(t),this._boxClass=t}},get:function(){return this.boxElement?this._boxClass:null}},{key:"visibility",set:function(t){this._visibility=t,"visible"===t?(0,s.default)(this.boxElement).show():(0,s.default)(this.boxElement).hide()},get:function(){return this._visibility}},{key:"overflow",set:function(t){this._overflow=t,(0,s.default)(this.boxElement).find(".dragbox-content").css("overflow-y",t)},get:function(){return this._overflow}},{key:"stickiness",get:function(){return this._stickiness},set:function(t){switch(t){case"glue":this.shouldStick=!0,this.shouldMagnetize=!1,(0,l.debuglog)("stickiness set to glue");break;case"magnetized":this.shouldStick=!1,this.shouldMagnetize=!0,(0,l.debuglog)("stickiness set to magnetized");break;default:this.shouldMagnetize=!1,this.shouldStick=!1,(0,l.debuglog)("Parambox: stickiness set to none")}this._stickiness=t}},{key:"title",get:function(){this.boxElement&&(0,s.default)(this.boxElement).find(".dragbox-title").html()},set:function(t){this.boxElement&&((0,s.default)(this.boxElement).find(".dragbox-title").html(t),this.updateSize())}},{key:"content",set:function(t){this.boxElement&&(this.contentDiv.html(t),this.updateSize())},get:function(){return this.boxElement?this.contentDiv.html():null}},{key:"contentDiv",get:function(){return this.boxElement?(0,s.default)(this.boxElement).find(".dragbox-content"):null}}],[{key:"getQueryString",value:function(){for(var t={},e=window.location.search.substring(1),n=e.split("&"),o=0;o<n.length;o++){var i=n[o].split("=");if(void 0===t[i[0]])t[i[0]]=decodeURIComponent(i[1]);else if("string"==typeof t[i[0]]){var r=[t[i[0]],decodeURIComponent(i[1])];t[i[0]]=r}else t[i[0]].push(decodeURIComponent(i[1]))}return t}},{key:"stayInWindow",value:function(t){if(void 0===t)throw new Error("element is undefined");var e=.15,n=t.offsetLeft,o=t.offsetLeft+t.offsetWidth,i=t.offsetTop,r=t.offsetTop+t.offsetHeigth,a=window.innerWidth-t.offsetWidth,s=window.innerHeight-t.offsetHeigth;return{x:n<0?0:o>window.innerWidth?a:n,y:i<0?0:r>window.innerHeight?s:i,stickyX:n<=0?-2:n<=e*t.offsetWidth?-1:o>=window.innerWidth?2:o>=window.innerWidth-e*t.offsetWidth?1:0,stickyY:i<=0?-2:i<=e*t.offsetHeigth?-1:r>=window.innerHeight?2:r>=window.innerHeight-e*t.offsetHeigth?1:0,leftSticky:n<=0?0:n<=e*t.offsetWidth?0:o>=window.innerWidth?window.innerWidth-t.offsetWidth:o>=window.innerWidth-e*t.offsetWidth?window.innerWidth-t.offsetWidth:n,topSticky:i<=0?0:i<=e*t.offsetHeigth?0:r>=window.innerHeight?window.innerHeight-t.offsetHeigth:r>=window.innerHeight-e*t.offsetHeigth?window.innerHeight-t.offsetHeigth:i}}},{key:"getCoordinateInWindow",value:function(t){return{left:t.offsetLeft,right:t.offsetLeft+t.offsetWidth,top:t.offsetTop,bottom:t.offsetTop+t.offsetHeigth,maxLeft:window.innerWidth-t.offsetWidth,maxTop:window.innerHeight-t.offsetHeigth}}},{key:"stickiness",get:function(){}},{key:"title",get:function(){}}]),e}();e.default=u}).call(e,n(9))},function(t,e,n){"use strict";function o(t){return t&&t.__esModule?t:{default:t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},l=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),u=n(0),d=o(u),c=n(4),f=o(c),h=n(1),b=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:(0,h.mandatory)("object"),n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:(0,h.mandatory)("property"),o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"input",l=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,u=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null;i(this,e);var d=r(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n,u));switch(d.VALID_FIELD_TYPE=["input","selector","slider"],d.field=null,d.fieldType=a,d.fieldHTML=null,d.allowedValues=l,d.tempClass="binded-"+(void 0===t?"undefined":s(t))+n,d.parent=o,d.fieldType){case"input":d.fieldHTML='<fieldset class="form-group"><label>'+n+'</label>\n        <input type="text" class="form-control '+d.tempClass+'" data-binded="'+n+'">\n        </fieldset>';break;case"selector":if(!l)throw new Error("fieldType selector needs at least one allowedValues");d.fieldHTML='<fieldset class="form-group">\n        <label>'+n+'</label>\n        <select class="form-control '+d.tempClass+'" data-binded="'+n+'">';for(var c=0;c<d.allowedValues.length;c++)d.fieldHTML=d.fieldHTML+'<option value="'+d.allowedValues[c]+'">'+d.allowedValues[c]+"</option>";d.fieldHTML=d.fieldHTML+"</select></fieldset>";break;case"slider":break;default:throw new Error("fieldType is invalid : input, selector and slider are the only valid type for now")}return o&&d.placeInParent(),d}return a(e,t),l(e,[{key:"placeInParent",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;t&&(this.parent=t),(0,d.default)(this.parent).append(this.fieldHTML),this.field=(0,d.default)("."+this.tempClass),this.field.removeClass("."+this.tempClass),this.allowedValues&&this.allowedValues.constructor===Array?this.allowedValues.indexOf(this.value)!==-1?this.field.val(this.value):this.field.val(this.allowedValues[0]):this.field.val(this.value);var e=this;this.field.change(function(){e.update("field")}),this.field.keydown(function(t){switch(t.keyCode){case 13:e.update("field")}})}},{key:"delete",value:function(){this.field.parent().remove(),this.property=null,this.object=null}},{key:"update",value:function(){"field"===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"field")?(this.value=(0,d.default)(this.field).val(),(0,d.default)(this.field).get(0).blur()):(0,d.default)(this.field).val().toUpperCase()!==String(this.value).toUpperCase()&&(0,d.default)(this.field).val(this.value)}},{key:"value",set:function(t){if(void 0===this.object[this.property])throw new Error("The variable you are trying to bind is undefined - either this object or the property is incorrect");this.object[this.property]=this.convertToType(t),this.update("setter")},get:function(){if(void 0===this.object[this.property])throw new Error("The variable you are trying to bind is undefined - either this object or the property is incorrect");return this.object[this.property]}}]),e}(f.default);e.default=b},function(t,e,n){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),a=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;o(this,t),this.HANDLED_VARIABLE_TYPES=["number","string","boolean"],this.property=n,this.object=e,this.propagate=!1,this.type=null,this.hierarchy=null!==i?i:n,this.exportName=this.hierarchy.replace(/\./g,"_"),this.object||(this.object=window),null!==n&&this.bind(e,n)}return r(t,[{key:"bind",value:function(t,e){var n=i(this.object[this.property]);if("undefined"===n)throw new Error("Parambox: The variable '"+e+"' you are trying to bind is undefined - either this object or the property is not defined");if(this.HANDLED_VARIABLE_TYPES.indexOf(n)===-1)throw new Error("The variable you are trying to bind is of a non-handled type (string, number or boolean)");this.property=e,this.object=t,this.type=this.object[this.property].constructor}},{key:"convertToType",value:function(t){if(this.type){if(this.type===Boolean)switch(String(t).toUpperCase()){case"0":return!1;case"1":return!0;case"FALSE":return!1;case"TRUE":return!0;default:throw new Error("BindedProperty.convertToType: invalid string value for boolean type")}return this.type(t)}throw new Error("You are trying to convert a value to a the type of the binded property but the object has no property binded to it (or no type)")}},{key:"value",set:function(t){if(void 0===this.object[this.property])throw new Error("The variable you are trying to bind is undefined - either this object or the property is incorrect");this.object[this.property]=this.convertToType(t)},get:function(){if(void 0===this.object[this.property])throw new Error("The variable you are trying to bind is undefined - either this object or the property is incorrect");return this.object[this.property]}}]),t}();e.default=a},function(t,e,n){"use strict";function o(t){return t&&t.__esModule?t:{default:t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var s=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),l=n(0),u=o(l),d=n(2),c=o(d),f=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"across",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"closebutton",a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;i(this,e);var s=r(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,a));if(s.DEFAULT_BUTTON_ROW_HTML='<div class="col-xs-12 dragbox-row smartmodal-buttonrow"></div>',s.DEFAULT_BUTTON_HTML={closebutton:'<button type="button" class="btn btn-secondary dragbox-button  smartmodal-closebutton">Close</button>',nextbutton:'<button type="button" class="btn btn-secondary dragbox-button smartmodal-nextbutton">Next</button>',blankbutton:'<button type="button" class="btn btn-secondary dragbox-button smartmodal-blankbutton"></button>',sendbutton:'<button type="button" class="btn btn-secondary dragbox-button smartmodal-sendbutton">Send</button>'},s.DEFAULT_FORMAT_TYPES={centralSmall:[.2,.4,.3],centralLarge:[.2,.7,.6],across:[.3,1,.4],overlay:[.1,.8,.8]},s.callback=n,s.draggable=!1,s.formatType=t,s.buttonRowHtml=s.DEFAULT_BUTTON_ROW_HTML,!(o in s.DEFAULT_BUTTON_HTML))throw new Error("buttonType invalid");s.buttonType=o,s.rows=[],s.title="<center><h5>Smart Modal</h5></center>",s.append(s.buttonRowHtml,".dragbox-footer"),s.append(s.DEFAULT_BUTTON_HTML[s.buttonType],".smartmodal-buttonrow"),s.button=(0,u.default)(s.boxElement).find(".smartmodal-"+s.buttonType),s.callAfterConstructor();var l=s;return(0,u.default)(window).resize(function(){l.updatePosition()}),(0,u.default)(s.button).click(function(){l.callThenDestroy()}),s}return a(e,t),s(e,[{key:"callAfterConstructor",value:function(){this.updatePosition(),this.updateSize(),this.show()}},{key:"callThenDestroy",value:function(){this.callback&&this.callback(),this.destroy()}},{key:"updatePosition",value:function(){var t=window.innerHeight,e=window.innerWidth,n=this.DEFAULT_FORMAT_TYPES[this.formatType],o=n[0]*t,i=e*((1-n[1])/2),r=e*n[1],a=t*n[2];return this.width=r,this.height=a,(0,u.default)(this.boxElement).animate({left:i,top:o},25,function(){}),!1}}]),e}(c.default);e.default=f},function(t,e,n){"use strict";function o(t){return t&&t.__esModule?t:{default:t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var s=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),l=n(0),u=o(l),d=n(2),c=o(d),f=n(3),h=o(f),b=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;i(this,e);var n=r(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));n.DEFAULT_ROW_HTML='<div class="col-md-12 dragbox-row paramboxtmprow"></div>',n.PARAMBOX_EMPTY_SUBTITLE_ROW_HTML='<div class="col-md-12 dragbox-row paramboxtmprow"><a class="parambox-subtitle">Subtitle</a></div>',n.PARAMBOX_EMPTY_ROW_HTML='<div class="col-md-12 dragbox-row parambox-empty"><center>No parameters binded.</center></div>',n.DEFAULT_BUTTON_ROW_HTML='<div class="col-xs-12 dragbox-row parambox-buttonrow"></div>',n.DEFAULT_BUTTON_HTML={savebutton:'<button type="button" class="btn btn-secondary btn-block dragbox-button parambox-savebutton">Save</button>',importbutton:'<button type="button" class="btn btn-secondary  btn-block dragbox-button parambox-importbutton">Import</button>',reloadbutton:'<button type="button" class="btn btn-secondary btn-block dragbox-button parambox-reloadbutton">Reload</button>'},n.append(n.DEFAULT_BUTTON_ROW_HTML,".dragbox-footer"),n.append(n.DEFAULT_BUTTON_HTML.savebutton,".parambox-buttonrow","col-xs-4"),n.append(n.DEFAULT_BUTTON_HTML.importbutton,".parambox-buttonrow","col-xs-4"),n.append(n.DEFAULT_BUTTON_HTML.reloadbutton,".parambox-buttonrow","col-xs-4");var o=n;return n.boxElement[0].getElementsByClassName("parambox-savebutton")[0].addEventListener("click",function(t){o.save(t)}),n.boxElement[0].getElementsByClassName("parambox-importbutton")[0].addEventListener("click",function(t){o.import(t)}),n.boxElement[0].getElementsByClassName("parambox-reloadbutton")[0].addEventListener("click",function(t){o.reloadAndImport(t)}),(0,u.default)(document).on("click",".parambox-subtitle",function(){var t=(0,u.default)(this).attr("subtitle-id");(0,u.default)("[parambox-belong-to='"+t+"']").slideToggle(250)}),n.rowHtml=n.DEFAULT_ROW_HTML,n.subtitleHtml=n.PARAMBOX_EMPTY_SUBTITLE_ROW_HTML,n.rows=[],n.subtitleRows={},n.title='<h5><i class="fa fa-cog fa-1x"></i> Parameter Box</h5>',n.overflow="scroll",void 0===window.paramPrefixIncrement?window.paramPrefixIncrement=0:window.paramPrefixIncrement+=1,n.prefix="paramBox"+window.paramPrefixIncrement,n.updateSize(),n.refreshView(),n}return a(e,t),s(e,[{key:"bind",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(void 0===t)throw new Error("object is undefined");var o=null;e.constructor!==Array&&(e=[e]);for(var i=0;i<e.length;i++){o=this.getDescendantProp(t,e[i]);var r=o[0],a=o[1],s=e[i].replace(/\./g,"_"),l=e[i].substring(0,e[i].lastIndexOf(".")),u=this.newRowInDom(l),d=null,c=null;if(void 0!==this.queryString[s]&&(c=this.queryString[s]),null!==n&&void 0!==n[e[i]]){var f=n[e[i]];if(null!==c){if(f.indexOf(c)===-1)throw new Error("ParamBox.bind: cannot set initial value to query string value of "+c+" because it is not in the constraints array.");r[a]=r[a].constructor(c)}d=new h.default(r,a,u,"selector",f,e[i])}null===d&&(null!==c&&(r[a]=r[a].constructor(c)),d=r[a].constructor===Boolean?new h.default(r,a,u,"selector",["TRUE","FALSE"],e[i]):new h.default(r,a,u,"input",null,e[i])),this.rows.push(this.getBindedRow(u,d))}this.refreshView()}},{key:"unbind",value:function(t,e){for(var n=0;n<this.rows.length;n++){var o=this.rows[n].bindedField;o.object===t&&o.property===e&&(this.rows.splice(n,1),o.delete())}this.refreshView()}},{key:"newRowInDom",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";if(""!==t&&!(t in this.subtitleRows)){var e=null;(0,u.default)(this.boxElement).find(".dragbox-content").append(this.subtitleHtml),e=this.boxElement.find(".paramboxtmprow"),(0,u.default)(e).removeClass("paramboxtmprow").find("a").attr("subtitle-id",t).text(t),this.subtitleRows[t]=(0,u.default)(e)}var n=null;return(0,u.default)(this.boxElement).find(".dragbox-content").append(this.rowHtml),n=this.boxElement.find(".paramboxtmprow"),(0,u.default)(n).removeClass("paramboxtmprow").attr("parambox-belong-to",t),n}},{key:"getBindedRow",value:function(t,e){return{rowDom:t,bindedField:e}}},{key:"refreshView",value:function(){this.rows.length?this.boxElement[0].getElementsByClassName("parambox-buttonrow")[0].style.visibility="visible":this.boxElement[0].getElementsByClassName("parambox-buttonrow")[0].style.visibility="hidden";var t=80+75*this.rows.length;t>600&&(t=600),this.height=t}},{key:"keyfunction",value:function(t){this.map[t.keyCode]="keydown"===t.type,this.map[16]&&this.map[80]&&(this.map[80]=!1,this.toggle(),t.preventDefault())}},{key:"getSummaryArray",value:function(){for(var t=[],e=0;e<this.rows.length;e++){var n=this.rows[e].bindedField;t.push({property:n.property,value:n.value,hierarchy:n.hierarchy,exportName:n.exportName})}return t}},{key:"import",value:function(){var t=prompt("Enter a JSON string:"),e=null;try{e=JSON.parse(t)}catch(t){console.error("ParamBox.import: Invalid JSON string - Parsing error:",t)}if(null!==e){e.constructor!==Array&&console.error("ParamBox.import: Invalid JSON string - the parent object needs to be of the same structure as the summaryArray");for(var n=0;n<e.length;n++)void 0===e[n].property&&console.error("ParamBox.import: importedJSON["+n+"].property is undefined. Invalid JSON string - the parent object needs to be of the same structure as the summaryArray."),void 0===e[n].value&&console.error("ParamBox.import: importedJSON["+n+"].value is undefined. Invalid JSON string - the parent object needs to be of the same structure as the summaryArray."),this.setProperty(e[n].property,e[n].value)}}},{key:"save",value:function(){var t=this.getSummaryArray(),e=JSON.stringify(t,null,2),n=30+70*t.length;n>500&&(n=500),window.open("data:application/json;"+(window.btoa?"base64,"+btoa(e):e),"ParamBox.save","width=400,height="+n)}},{key:"reloadAndImport",value:function(){for(var t=this.getSummaryArray(),e="",n=0;n<t.length;n++)""!==e&&(e+="&"),e+=t[n].exportName+"="+encodeURIComponent(t[n].value);var o=window.location.href,i=o.indexOf("?");i!==-1&&(o=o.substring(0,i)),o+="?"+e,window.location.href=o}},{key:"getDescendantProp",value:function(t,e){for(var n=e.split("."),o=null,i=null;n.length;){if(o=t,i=n.shift(),void 0===t[i])throw new Error("object property "+i+" is undefined");t=t[i]}return[o,i,t]}},{key:"setProperty",value:function(t,e){if(t.constructor!==String)throw new Error("ParamBox.setProperty: property needs to be a string.");for(var n=!1,o=0;o<this.rows.length;o++)this.rows[o].bindedField.property===t&&(this.rows[o].bindedField.value=e,n=!0);n===!1&&console.warn("ParamBox.setProperty: did not find property "+t)}}]),e}(c.default);e.default=b},function(t,e,n){"use strict";function o(t){return t&&t.__esModule?t:{default:t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var s=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),l=n(10),u=o(l),d=n(0),c=o(d),f=n(5),h=o(f),b=n(1),p=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:(0,b.mandatory)(),n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(i(this,e),void 0===u.default)throw new Error("SmartChart.constructor: Chart.js is not loaded.");if(t.constructor!==Object)throw new Error("SmartChart.constructor: options needs to be an object (chart.js chart options)");var a=r(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,"overlay",n,"closebutton",o));a.chartOptions=c.default.extend(!0,{},t),a.title="<center><h5>Smart Chart</h5></center>";var s="chart-canvas"+((0,c.default)("canvas").length+1);a.content='<canvas id="'+s+'" class="chart-canvas"></canvas>',a.canvas=document.getElementById(s),void 0!==t.options.title.text&&(t.options.title.display=!1,a.title="<center><h5>"+t.options.title.text+"</h5></center>");try{u.default.defaults.global.responsive=!0,u.default.defaults.global.maintainAspectRatio=!1,a.chart=new u.default(a.canvas,t)}catch(t){throw new Error("SmartChart.constructor: could not build the chart. Error: "+t)}return a.canvas.style.background="white",a.boxClass="dragbox dragbox-white-boxshadow",a.DEFAULT_BUTTON_ROW_HTML='<div class="col-xs-12 dragbox-row smartchart-buttonrow"><div class="col-xs-10"></div></div>',a.DEFAULT_BUTTON_HTML={closebutton:'<button type="button" class="btn btn-secondary dragbox-button  smartchart-closebutton">Close</button>',savebutton:'<button type="button" class="btn btn-secondary dragbox-button smartchart-savebutton">Save</button>'},a.html(".dragbox-footer",a.DEFAULT_BUTTON_ROW_HTML),a.append(a.DEFAULT_BUTTON_HTML.savebutton,".smartchart-buttonrow","col-xs-1 centered"),a.append(a.DEFAULT_BUTTON_HTML.closebutton,".smartchart-buttonrow","col-xs-1 centered"),a.closeButton=(0,c.default)(a.boxElement).find(".smartchart-closebutton"),a.saveButton=(0,c.default)(a.boxElement).find(".smartchart-savebutton"),a.button=a.closeButton,(0,c.default)(a.closeButton).click(function(){a.callThenDestroy()}),(0,c.default)(a.saveButton).click(function(){a.save()}),a.updatePosition(),a.updateSize(),setTimeout(function(){a.chart.resize(),a.show()},250),a}return a(e,t),s(e,[{key:"callAfterConstructor",value:function(){}},{key:"callThenDestroy",value:function(){this.callback&&this.callback(),void 0!==this.chart&&void 0!==u.default&&this.chart.constructor===u.default&&this.chart.destroy(),this.destroy()}},{key:"save",value:function(){var t=JSON.stringify(this.chartOptions,null,2),e=150+150*this.chartOptions.data.datasets.length;e>500&&(e=500),window.open("data:application/json;"+(window.btoa?"base64,"+btoa(t):t),"SmartChart.save","width=400,height="+e)}}]),e}(h.default);e.default=p},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.DEBUG_MODE_ON=!0},function(t,e){var n;n=function(){return this}();try{n=n||Function("return this")()||(0,eval)("this")}catch(t){"object"==typeof window&&(n=window)}t.exports=n},function(t,n){t.exports=e},function(t,e){t.exports=n},function(t,e){t.exports=o},function(t,e,n){"use strict";function o(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0}),e.BindedField=e.BindedProperty=e.SmartChart=e.SmartModal=e.ParamBox=e.DragBox=void 0;var i=n(2),r=o(i),a=n(6),s=o(a),l=n(5),u=o(l),d=n(7),c=o(d),f=n(4),h=o(f),b=n(3),p=o(b),y=n(1);if("undefined"!=typeof window){window.DragBox=r.default,window.ParamBox=s.default,window.SmartModal=u.default,window.SmartChart=c.default,window.BindedProperty=h.default,window.BindedField=p.default;var v=document.getElementsByTagName("script"),g=v[v.length-1].src,m=(0,y.findAllIndices)("/",g);g=g.substr(0,m[m.length-1]),document.addEventListener("DOMContentLoaded",function(){var t=document.getElementsByTagName("head")[0],e=document.createElement("link");e.rel="stylesheet",e.type="text/css",e.href=g+"/experimentBoxes.css",t.appendChild(e)})}e.DragBox=r.default,e.ParamBox=s.default,e.SmartModal=u.default,e.SmartChart=c.default,e.BindedProperty=h.default,e.BindedField=p.default}])});