!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e(require("jQuery"),require("experiment-mathjs"),require("lodash")):"function"==typeof define&&define.amd?define("experimentBoxes",["jQuery","experiment-mathjs","lodash"],e):"object"==typeof exports?exports.experimentBoxes=e(require("jQuery"),require("experiment-mathjs"),require("lodash")):t.experimentBoxes=e(t.jQuery,t.math,t._)}(this,function(t,e,n){return function(t){function e(o){if(n[o])return n[o].exports;var i=n[o]={i:o,l:!1,exports:{}};return t[o].call(i.exports,i,i.exports,e),i.l=!0,i.exports}var n={};return e.m=t,e.c=n,e.i=function(t){return t},e.d=function(t,n,o){e.o(t,n)||Object.defineProperty(t,n,{configurable:!1,enumerable:!0,get:o})},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=8)}([function(e,n){e.exports=t},function(t,e,n){"use strict";function o(t){return t&&t.__esModule?t:{default:t}}function i(){}function r(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";throw new Error("Missing parameter "+t)}function a(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];for(var o=0;o<e.length;o++)if(void 0===e[o])throw new Error("Argument "+o+" is undefined.");return!0}function l(t){for(var e=arguments.length,n=Array(e>1?e-1:0),o=1;o<e;o++)n[o-1]=arguments[o];if(n.allHaveConstructor(t)===!1)throw new Error("Wrong constructor in arguments.");return!0}function s(t){return t&&"function"==typeof t.then&&"function"==typeof t.catch}function u(t){return new Promise(function(e){setTimeout(e,t)})}function f(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:r(),e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:r();return new Promise(function(n){var o=w.default.random(t,e);setTimeout(n,o)})}function d(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:r(),e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:r(),n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[];return 0===e?new Promise(function(t){t(i)}):t.apply(n,o).then(function(r){return i=i.concat(r),d(t,e-1,n,o,i)})}function h(){var t=this;this.resolve=null,this.reject=null,this.promise=new Promise(function(e,n){t.resolve=e,t.reject=n}),Object.freeze(this)}function c(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:r(),e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:r(),n=[];if("function"==typeof t)for(var o=0;o<e;o++)n=n.concat(t(o));else for(var i=0;i<e;i++)n=n.concat(t);return n}function b(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:r(),e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(t.constructor!==Array)throw new Error("samplePermutation: sequence needs to be an array.");null===n&&(n=t.length);for(var o=t.slice(0),i=[],a=void 0;e&&i.length<n||!e&&o.length;){var l=Math.floor(Math.random()*o.length);a=e?o[l]:o.splice(l,1),i=i.concat(a)}return i}function g(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:r(),e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:r(),n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=[],i=0;i<t;i++){o[i]=[];for(var a=0;a<e;a++)o[i][a]=n}return o}function p(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:r(),e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:r();t=S.default.matrix(t);var n=t.size()[0];return S.default.subset(t,S.default.index(e,S.default.range(0,n)))}function y(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:r(),e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;t=S.default.matrix(t);var n=t.size()[0];null===e&&(e=S.default.range(0,n-1)),e.constructor!==Array&&(e=[e]);for(var o=[],i=0;i<e.length;i++)o.push(S.default.sum(p(t,e[i])));return o}function v(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:r(),e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=t.length,o=[],i=0;i<n;i++)e&&(t[i][i]=e),o.push(t[i][i]);return[o,t]}function m(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:r(),e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:r(),n=[],o=0;o<e.length;o++)e.substr(o,t.length)===t&&n.push(o);return n.length?n:-1}Object.defineProperty(e,"__esModule",{value:!0}),e.findAllIndices=e.noop=e.debugError=e.debugWarn=e.debuglog=e.mandatory=e.mustBeDefined=e.mustHaveConstructor=e.looksLikeAPromise=e.delay=e.jitter=e.recurse=e.Deferred=e.rep=e.samplePermutation=e.matrix=e.getRow=e.rowSum=e.diag=void 0;var x=n(13),w=o(x),T=n(12),S=o(T),k=n(9),_=k.DEBUG_MODE_ON?console.log.bind(console):i,E=k.DEBUG_MODE_ON?console.warn.bind(console):i,M=k.DEBUG_MODE_ON?console.error.bind(console):i;e.diag=v,e.rowSum=y,e.getRow=p,e.matrix=g,e.samplePermutation=b,e.rep=c,e.Deferred=h,e.recurse=d,e.jitter=f,e.delay=u,e.looksLikeAPromise=s,e.mustHaveConstructor=l,e.mustBeDefined=a,e.mandatory=r,e.debuglog=_,e.debugWarn=E,e.debugError=M,e.noop=i,e.findAllIndices=m},function(t,e,n){"use strict";(function(t){function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),r=n(0),a=function(t){return t&&t.__esModule?t:{default:t}}(r),l=n(1),s=function(){function e(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;o(this,e),"undefined"==typeof window&&(t.window={}),this.MAX_BINDED_PROPERTIES=15,this.INIT_WIDTH=i||400,this.INIT_HEIGHT=r||300,this.TITLE_HEIGHT=36,this.FOOTER_HEIGHT=34,this.DEFAULT_BOX_THEME="dragbox-gray",this.DEFAULT_DRAGGABLE=!0,this.DEFAULT_STICKINESS_TYPE="magnetized",this.boxId=null,this.boxElement=n,this.draggable=this.DEFAULT_DRAGGABLE,this.boxHTML=null,this.shouldStick=null,this.shouldMagnetize=null,this.isStickingX=null,this.isStickingY=null,this.stickiness=this.DEFAULT_STICKINESS_TYPE,this._beingDragged=!1,this._visibility="hidden",this._overflow="hidden",this._boxClass=this.DEFAULT_BOX_THEME,this._width=this.INIT_WIDTH,this._height=this.INIT_HEIGHT,this.map=[],this.currentMousePos={x:-1,y:-1};var l=this;(0,a.default)(document).mousemove(function(t){l.currentMousePos.x=t.pageX,l.currentMousePos.y=t.pageY}),this.boxElement?this.boxId=(0,a.default)(this.boxElement).attr("id"):(this.boxId="dragbox"+((0,a.default)('div[id*="dragbox"]').length+1),this.boxHTML='<div id="'+this.boxId+'" class="dragbox '+this._boxClass+'" style="display:none;" draggable="false">\n          <div class="col-xs-12 dragbox-container">\n            <div class="col-xs-12 dragbox-title"><center><h3>Dragbox</h3></center>\n          </div>\n          <div class="col-xs-12 dragbox-content"></div>\n          <div class="col-xs-12 dragbox-footer"></div>\n        </div>',(0,a.default)(document.body).append(this.boxHTML),this.boxElement=(0,a.default)("#"+this.boxId)),this.boxClass=(0,a.default)(this.boxElement).attr("class"),this.width=this._width,this.height=this._height,this.overflow="hidden",(0,a.default)(document.body).keydown(function(t){l.keyfunction(t)}),(0,a.default)(document.body).keyup(function(t){l.keyfunction(t)}),(0,a.default)(this.boxElement).click(function(){(0,a.default)(".dragbox").css("zIndex",10),(0,a.default)(l.boxElement).css("zIndex",100)}),(0,a.default)(this.boxElement).find(".dragbox-title").mousedown(function(t){l.startDrag(t)}),(0,a.default)(this.boxElement).find(".dragbox-title").mouseup(function(t){l.stopDrag(t)}),(0,a.default)(document).click(function(t){l.stopDrag(t)}),this.queryString=e.getQueryString()}return i(e,[{key:"destroy",value:function(){var t=this;(0,a.default)(this.boxElement).animate({opacity:0},25,function(){(0,a.default)(t.boxElement).remove()})}},{key:"updateSize",value:function(){(0,a.default)(this.boxElement).width(this.width),(0,a.default)(this.boxElement).height(this.height);var t=this.height-this.TITLE_HEIGHT-this.FOOTER_HEIGHT-7,e=this;(0,a.default)(this.boxElement).animate({height:e.height,width:e.width},25,function(){}),(0,a.default)(this.boxElement).find(".dragbox-container").animate({height:e.height},25,function(){}),(0,a.default)(this.boxElement).find(".dragbox-content").animate({height:t},25,function(){})}},{key:"startDrag",value:function(t){if(t.preventDefault(),this.beingDragged)return this.beingDragged=!1,null;if(!this.draggable)return null;var e={x:t.clientX-(0,a.default)(this.boxElement).offset().left,y:t.clientY-(0,a.default)(this.boxElement).offset().top};return this.beingDragged=!0,this.loopDrag(e),!1}},{key:"stopDrag",value:function(){this.beingDragged=!1}},{key:"loopDrag",value:function(t){if(this.beingDragged===!0){var n=this.currentMousePos.x-t.x,o=this.currentMousePos.y-t.y,i={offsetLeft:n,offsetTop:o,offsetWidth:(0,a.default)(this.boxElement).width(),offsetHeigth:(0,a.default)(this.boxElement).height()},r=e.stayInWindow(i),l=r.x,s=r.y;this.shouldStick&&(r.stickyX!==-2&&2!==r.stickyX||(this.isStickingX=!0),this.isStickingX&&0!==r.stickyX&&(l=r.leftSticky),0===r.stickyX&&(this.isStickingX=!1),r.stickyY!==-2&&2!==r.stickyY||(this.isStickingY=!0),this.isStickingY&&0!==r.stickyY&&(s=r.topSticky),0===r.stickyY&&(this.isStickingY=!1)),this.shouldMagnetize&&(l=r.leftSticky,s=r.topSticky);var u=this;(0,a.default)(this.boxElement).animate({left:l,top:s},25,function(){u.loopDrag(t)})}}},{key:"keyfunction",value:function(){(0,l.debuglog)("dragbox: keyfunction() called.",this)}},{key:"toggle",value:function(){"hidden"===this.visibility?this.visibility="visible":this.visibility="hidden"}},{key:"show",value:function(){this.visibility="visible"}},{key:"hide",value:function(){this.visibility="hidden"}},{key:"append",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:".dragbox-content",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this.boxElement&&(null!==n&&(t='<div class="'+n+'" >'+t+"</div>"),"container"!==e?this.boxElement.find(e).append(t):this.boxElement.append(t))}},{key:"html",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:".dragbox-content",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(this.boxElement){var n="container"!==t?this.boxElement.find(t):this.boxElement;return null!==e?(n.html(e),e):n.html()}return null}},{key:"width",set:function(t){this._width=t,this.updateSize()},get:function(){return this._width}},{key:"height",set:function(t){this._height=t,this.updateSize()},get:function(){return this._height}},{key:"beingDragged",set:function(t){this._beingDragged=t,(0,a.default)(this.boxElement).attr("beingDragged",t)},get:function(){return this._beingDragged}},{key:"boxClass",set:function(t){if(this.boxElement){if("string"!=typeof t)throw new Error("newClass must be a string");this.boxElement.removeClass(this.boxClass).addClass(t),this._boxClass=t}},get:function(){return this.boxElement?this._boxClass:null}},{key:"visibility",set:function(t){this._visibility=t,"visible"===t?(0,a.default)(this.boxElement).show():(0,a.default)(this.boxElement).hide()},get:function(){return this._visibility}},{key:"overflow",set:function(t){this._overflow=t,(0,a.default)(this.boxElement).find(".dragbox-content").css("overflow-y",t)},get:function(){return this._overflow}},{key:"stickiness",get:function(){return this._stickiness},set:function(t){switch(t){case"glue":this.shouldStick=!0,this.shouldMagnetize=!1,(0,l.debuglog)("stickiness set to glue");break;case"magnetized":this.shouldStick=!1,this.shouldMagnetize=!0,(0,l.debuglog)("stickiness set to magnetized");break;default:this.shouldMagnetize=!1,this.shouldStick=!1,(0,l.debuglog)("Parambox: stickiness set to none")}this._stickiness=t}},{key:"title",get:function(){this.boxElement&&(0,a.default)(this.boxElement).find(".dragbox-title").html()},set:function(t){this.boxElement&&((0,a.default)(this.boxElement).find(".dragbox-title").html(t),this.updateSize())}},{key:"content",set:function(t){this.boxElement&&(this.contentDiv.html(t),this.updateSize())},get:function(){return this.boxElement?this.contentDiv.html():null}},{key:"contentDiv",get:function(){return this.boxElement?(0,a.default)(this.boxElement).find(".dragbox-content"):null}}],[{key:"getQueryString",value:function(){for(var t={},e=window.location.search.substring(1),n=e.split("&"),o=0;o<n.length;o++){var i=n[o].split("=");if(void 0===t[i[0]])t[i[0]]=decodeURIComponent(i[1]);else if("string"==typeof t[i[0]]){var r=[t[i[0]],decodeURIComponent(i[1])];t[i[0]]=r}else t[i[0]].push(decodeURIComponent(i[1]))}return t}},{key:"stayInWindow",value:function(t){if(void 0===t)throw new Error("element is undefined");var e=t.offsetLeft,n=t.offsetLeft+t.offsetWidth,o=t.offsetTop,i=t.offsetTop+t.offsetHeigth,r=window.innerWidth-t.offsetWidth,a=window.innerHeight-t.offsetHeigth;return{x:e<0?0:n>window.innerWidth?r:e,y:o<0?0:i>window.innerHeight?a:o,stickyX:e<=0?-2:e<=.15*t.offsetWidth?-1:n>=window.innerWidth?2:n>=window.innerWidth-.15*t.offsetWidth?1:0,stickyY:o<=0?-2:o<=.15*t.offsetHeigth?-1:i>=window.innerHeight?2:i>=window.innerHeight-.15*t.offsetHeigth?1:0,leftSticky:e<=0?0:e<=.15*t.offsetWidth?0:n>=window.innerWidth?window.innerWidth-t.offsetWidth:n>=window.innerWidth-.15*t.offsetWidth?window.innerWidth-t.offsetWidth:e,topSticky:o<=0?0:o<=.15*t.offsetHeigth?0:i>=window.innerHeight?window.innerHeight-t.offsetHeigth:i>=window.innerHeight-.15*t.offsetHeigth?window.innerHeight-t.offsetHeigth:o}}},{key:"getCoordinateInWindow",value:function(t){return{left:t.offsetLeft,right:t.offsetLeft+t.offsetWidth,top:t.offsetTop,bottom:t.offsetTop+t.offsetHeigth,maxLeft:window.innerWidth-t.offsetWidth,maxTop:window.innerHeight-t.offsetHeigth}}},{key:"stickiness",get:function(){}},{key:"title",get:function(){}}]),e}();e.default=s}).call(e,n(11))},function(t,e,n){"use strict";function o(t){return t&&t.__esModule?t:{default:t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},s=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),u=n(0),f=o(u),d=n(4),h=o(d),c=n(1),b=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:(0,c.mandatory)("object"),n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:(0,c.mandatory)("property"),o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"input",s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,u=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null;i(this,e);var f=r(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n,u));switch(f.VALID_FIELD_TYPE=["input","selector","slider"],f.field=null,f.fieldType=a,f.fieldHTML=null,f.allowedValues=s,f.tempClass="binded-"+(void 0===t?"undefined":l(t))+n,f.parent=o,f.fieldType){case"input":f.fieldHTML='<fieldset class="form-group"><label>'+n+'</label>\n        <input type="text" class="form-control '+f.tempClass+'" data-binded="'+n+'">\n        </fieldset>';break;case"selector":if(!s)throw new Error("fieldType selector needs at least one allowedValues");f.fieldHTML='<fieldset class="form-group">\n        <label>'+n+'</label>\n        <select class="form-control '+f.tempClass+'" data-binded="'+n+'">';for(var d=0;d<f.allowedValues.length;d++)f.fieldHTML=f.fieldHTML+'<option value="'+f.allowedValues[d]+'">'+f.allowedValues[d]+"</option>";f.fieldHTML=f.fieldHTML+"</select></fieldset>";break;case"slider":break;default:throw new Error("fieldType is invalid : input, selector and slider are the only valid type for now")}return o&&f.placeInParent(),f}return a(e,t),s(e,[{key:"placeInParent",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;t&&(this.parent=t),(0,f.default)(this.parent).append(this.fieldHTML),this.field=(0,f.default)("."+this.tempClass),this.field.removeClass("."+this.tempClass),this.allowedValues&&this.allowedValues.constructor===Array?this.allowedValues.indexOf(this.value)!==-1?this.field.val(this.value):this.field.val(this.allowedValues[0]):this.field.val(this.value);var e=this;this.field.change(function(){e.update("field")}),this.field.keydown(function(t){switch(t.keyCode){case 13:e.update("field")}})}},{key:"delete",value:function(){this.field.parent().remove(),this.property=null,this.object=null}},{key:"update",value:function(){"field"===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"field")?(this.value=(0,f.default)(this.field).val(),(0,f.default)(this.field).get(0).blur()):(0,f.default)(this.field).val().toUpperCase()!==String(this.value).toUpperCase()&&(0,f.default)(this.field).val(this.value)}},{key:"value",set:function(t){if(void 0===this.object[this.property])throw new Error("The variable you are trying to bind is undefined - either this object or the property is incorrect");this.object[this.property]=this.convertToType(t),this.update("setter")},get:function(){if(void 0===this.object[this.property])throw new Error("The variable you are trying to bind is undefined - either this object or the property is incorrect");return this.object[this.property]}}]),e}(h.default);e.default=b},function(t,e,n){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),a=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;o(this,t),this.HANDLED_VARIABLE_TYPES=["number","string","boolean"],this.property=n,this.object=e,this.propagate=!1,this.type=null,this.hierarchy=null!==i?i:n,this.exportName=this.hierarchy.replace(/\./g,"_"),this.object||(this.object=window),null!==n&&this.bind(e,n)}return r(t,[{key:"bind",value:function(t,e){var n=i(this.object[this.property]);if("undefined"===n)throw new Error("Parambox: The variable '"+e+"' you are trying to bind is undefined - either this object or the property is not defined");if(this.HANDLED_VARIABLE_TYPES.indexOf(n)===-1)throw new Error("The variable you are trying to bind is of a non-handled type (string, number or boolean)");this.property=e,this.object=t,this.type=this.object[this.property].constructor}},{key:"convertToType",value:function(t){if(this.type){if(this.type===Boolean)switch(String(t).toUpperCase()){case"0":return!1;case"1":return!0;case"FALSE":return!1;case"TRUE":return!0;default:throw new Error("BindedProperty.convertToType: invalid string value for boolean type")}return this.type(t)}throw new Error("You are trying to convert a value to a the type of the binded property but the object has no property binded to it (or no type)")}},{key:"value",set:function(t){if(void 0===this.object[this.property])throw new Error("The variable you are trying to bind is undefined - either this object or the property is incorrect");this.object[this.property]=this.convertToType(t)},get:function(){if(void 0===this.object[this.property])throw new Error("The variable you are trying to bind is undefined - either this object or the property is incorrect");return this.object[this.property]}}]),t}();e.default=a},function(t,e,n){"use strict";function o(t){return t&&t.__esModule?t:{default:t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var l=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),s=n(0),u=o(s),f=n(2),d=o(f),h=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"across",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"closebutton",a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;i(this,e);var l=r(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,a));if(l.DEFAULT_BUTTON_ROW_HTML='<div class="col-xs-12 dragbox-row smartmodal-buttonrow"></div>',l.DEFAULT_BUTTON_HTML={closebutton:'<button type="button" class="btn btn-secondary dragbox-button  smartmodal-closebutton">Close</button>',nextbutton:'<button type="button" class="btn btn-secondary dragbox-button smartmodal-nextbutton">Next</button>',blankbutton:'<button type="button" class="btn btn-secondary dragbox-button smartmodal-blankbutton"></button>',sendbutton:'<button type="button" class="btn btn-secondary dragbox-button smartmodal-sendbutton">Send</button>'},l.DEFAULT_FORMAT_TYPES={centralSmall:[.2,.4,.3],centralLarge:[.2,.7,.6],across:[.3,1,.4],overlay:[.1,.8,.8]},l.callback=n,l.draggable=!1,l.formatType=t,l.buttonRowHtml=l.DEFAULT_BUTTON_ROW_HTML,!(o in l.DEFAULT_BUTTON_HTML))throw new Error("buttonType invalid");l.buttonType=o,l.rows=[],l.title="<center><h5>Smart Modal</h5></center>",l.append(l.buttonRowHtml,".dragbox-footer"),l.append(l.DEFAULT_BUTTON_HTML[l.buttonType],".smartmodal-buttonrow"),l.button=(0,u.default)(l.boxElement).find(".smartmodal-"+l.buttonType),l.callAfterConstructor();var s=l;return(0,u.default)(window).resize(function(){s.updatePosition()}),(0,u.default)(l.button).click(function(){s.callThenDestroy()}),l}return a(e,t),l(e,[{key:"callAfterConstructor",value:function(){this.updatePosition(),this.updateSize(),this.show()}},{key:"callThenDestroy",value:function(){this.callback&&this.callback(),this.destroy()}},{key:"updatePosition",value:function(){var t=window.innerHeight,e=window.innerWidth,n=this.DEFAULT_FORMAT_TYPES[this.formatType],o=n[0]*t,i=e*((1-n[1])/2),r=e*n[1],a=t*n[2];return this.width=r,this.height=a,(0,u.default)(this.boxElement).animate({left:i,top:o},25,function(){}),!1}}]),e}(d.default);e.default=h},function(t,e,n){"use strict";function o(t){return t&&t.__esModule?t:{default:t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var l=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),s=n(0),u=o(s),f=n(2),d=o(f),h=n(3),c=o(h),b=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;i(this,e);var n=r(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));n.DEFAULT_ROW_HTML='<div class="col-md-12 dragbox-row paramboxtmprow"></div>',n.PARAMBOX_EMPTY_SUBTITLE_ROW_HTML='<div class="col-md-12 dragbox-row paramboxtmprow"><a class="parambox-subtitle">Subtitle</a></div>',n.PARAMBOX_EMPTY_ROW_HTML='<div class="col-md-12 dragbox-row parambox-empty"><center>No parameters binded.</center></div>',n.DEFAULT_BUTTON_ROW_HTML='<div class="col-xs-12 dragbox-row parambox-buttonrow"></div>',n.DEFAULT_BUTTON_HTML={savebutton:'<button type="button" class="btn btn-secondary btn-block dragbox-button parambox-savebutton">Save</button>',importbutton:'<button type="button" class="btn btn-secondary  btn-block dragbox-button parambox-importbutton">Import</button>',reloadbutton:'<button type="button" class="btn btn-secondary btn-block dragbox-button parambox-reloadbutton">Reload</button>'},n.append(n.DEFAULT_BUTTON_ROW_HTML,".dragbox-footer"),n.append(n.DEFAULT_BUTTON_HTML.savebutton,".parambox-buttonrow","col-xs-4"),n.append(n.DEFAULT_BUTTON_HTML.importbutton,".parambox-buttonrow","col-xs-4"),n.append(n.DEFAULT_BUTTON_HTML.reloadbutton,".parambox-buttonrow","col-xs-4");var o=n;return n.boxElement[0].getElementsByClassName("parambox-savebutton")[0].addEventListener("click",function(t){o.save(t)}),n.boxElement[0].getElementsByClassName("parambox-importbutton")[0].addEventListener("click",function(t){o.import(t)}),n.boxElement[0].getElementsByClassName("parambox-reloadbutton")[0].addEventListener("click",function(t){o.reloadAndImport(t)}),(0,u.default)(document).on("click",".parambox-subtitle",function(){var t=(0,u.default)(this).attr("subtitle-id");(0,u.default)("[parambox-belong-to='"+t+"']").slideToggle(250)}),n.rowHtml=n.DEFAULT_ROW_HTML,n.subtitleHtml=n.PARAMBOX_EMPTY_SUBTITLE_ROW_HTML,n.rows=[],n.subtitleRows={},n.title='<h5><i class="fa fa-cog fa-1x"></i> Parameter Box</h5>',n.overflow="scroll",void 0===window.paramPrefixIncrement?window.paramPrefixIncrement=0:window.paramPrefixIncrement+=1,n.prefix="paramBox"+window.paramPrefixIncrement,n.updateSize(),n.refreshView(),n}return a(e,t),l(e,[{key:"bind",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(void 0===t)throw new Error("object is undefined");var o=null;e.constructor!==Array&&(e=[e]);for(var i=0;i<e.length;i++){o=this.getDescendantProp(t,e[i]);var r=o[0],a=o[1],l=e[i].replace(/\./g,"_"),s=e[i].substring(0,e[i].lastIndexOf(".")),u=this.newRowInDom(s),f=null,d=null;if(void 0!==this.queryString[l]&&(d=this.queryString[l]),null!==n&&void 0!==n[e[i]]){var h=n[e[i]];if(null!==d){if(h.indexOf(d)===-1)throw new Error("ParamBox.bind: cannot set initial value to query string value of "+d+" because it is not in the constraints array.");r[a]=r[a].constructor(d)}f=new c.default(r,a,u,"selector",h,e[i])}null===f&&(null!==d&&(r[a]=r[a].constructor(d)),f=r[a].constructor===Boolean?new c.default(r,a,u,"selector",["TRUE","FALSE"],e[i]):new c.default(r,a,u,"input",null,e[i])),this.rows.push(this.getBindedRow(u,f))}this.refreshView()}},{key:"unbind",value:function(t,e){for(var n=0;n<this.rows.length;n++){var o=this.rows[n].bindedField;o.object===t&&o.property===e&&(this.rows.splice(n,1),o.delete())}this.refreshView()}},{key:"newRowInDom",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";if(""!==t&&!(t in this.subtitleRows)){var e=null;(0,u.default)(this.boxElement).find(".dragbox-content").append(this.subtitleHtml),e=this.boxElement.find(".paramboxtmprow"),(0,u.default)(e).removeClass("paramboxtmprow").find("a").attr("subtitle-id",t).text(t),this.subtitleRows[t]=(0,u.default)(e)}var n=null;return(0,u.default)(this.boxElement).find(".dragbox-content").append(this.rowHtml),n=this.boxElement.find(".paramboxtmprow"),(0,u.default)(n).removeClass("paramboxtmprow").attr("parambox-belong-to",t),n}},{key:"getBindedRow",value:function(t,e){return{rowDom:t,bindedField:e}}},{key:"refreshView",value:function(){this.rows.length?this.boxElement[0].getElementsByClassName("parambox-buttonrow")[0].style.visibility="visible":this.boxElement[0].getElementsByClassName("parambox-buttonrow")[0].style.visibility="hidden";var t=80+75*this.rows.length;t>600&&(t=600),this.height=t}},{key:"keyfunction",value:function(t){this.map[t.keyCode]="keydown"===t.type,this.map[16]&&this.map[80]&&(this.map[80]=!1,this.toggle(),t.preventDefault())}},{key:"getSummaryArray",value:function(){for(var t=[],e=0;e<this.rows.length;e++){var n=this.rows[e].bindedField;t.push({property:n.property,value:n.value,hierarchy:n.hierarchy,exportName:n.exportName})}return t}},{key:"import",value:function(){var t=prompt("Enter a JSON string:"),e=null;try{e=JSON.parse(t)}catch(t){console.error("ParamBox.import: Invalid JSON string - Parsing error:",t)}if(null!==e){e.constructor!==Array&&console.error("ParamBox.import: Invalid JSON string - the parent object needs to be of the same structure as the summaryArray");for(var n=0;n<e.length;n++)void 0===e[n].property&&console.error("ParamBox.import: importedJSON["+n+"].property is undefined. Invalid JSON string - the parent object needs to be of the same structure as the summaryArray."),void 0===e[n].value&&console.error("ParamBox.import: importedJSON["+n+"].value is undefined. Invalid JSON string - the parent object needs to be of the same structure as the summaryArray."),this.setProperty(e[n].property,e[n].value)}}},{key:"save",value:function(){var t=this.getSummaryArray(),e=JSON.stringify(t,null,2),n=30+70*t.length;n>500&&(n=500),window.open("data:application/json;"+(window.btoa?"base64,"+btoa(e):e),"ParamBox.save","width=400,height="+n)}},{key:"reloadAndImport",value:function(){for(var t=this.getSummaryArray(),e="",n=0;n<t.length;n++)""!==e&&(e+="&"),e+=t[n].exportName+"="+encodeURIComponent(t[n].value);var o=window.location.href,i=o.indexOf("?");i!==-1&&(o=o.substring(0,i)),o+="?"+e,window.location.href=o}},{key:"getDescendantProp",value:function(t,e){for(var n=e.split("."),o=null,i=null;n.length;){if(o=t,i=n.shift(),void 0===t[i])throw new Error("object property "+i+" is undefined");t=t[i]}return[o,i,t]}},{key:"setProperty",value:function(t,e){if(t.constructor!==String)throw new Error("ParamBox.setProperty: property needs to be a string.");for(var n=!1,o=0;o<this.rows.length;o++)this.rows[o].bindedField.property===t&&(this.rows[o].bindedField.value=e,n=!0);n===!1&&console.warn("ParamBox.setProperty: did not find property "+t)}}]),e}(d.default);e.default=b},function(t,e,n){"use strict";function o(t){return t&&t.__esModule?t:{default:t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var l=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),s=n(10),u=o(s),f=n(0),d=o(f),h=n(5),c=o(h),b=n(1),g=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:(0,b.mandatory)(),n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(i(this,e),void 0===u.default)throw new Error("SmartChart.constructor: Chart.js is not loaded.");if(t.constructor!==Object)throw new Error("SmartChart.constructor: options needs to be an object (chart.js chart options)");var a=r(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,"overlay",n,"closebutton",o));a.chartOptions=d.default.extend(!0,{},t),a.title="<center><h5>Smart Chart</h5></center>";var l="chart-canvas"+((0,d.default)("canvas").length+1);a.content='<canvas id="'+l+'" class="chart-canvas"></canvas>',a.canvas=document.getElementById(l),void 0!==t.options.title.text&&(t.options.title.display=!1,a.title="<center><h5>"+t.options.title.text+"</h5></center>");try{u.default.defaults.global.responsive=!0,u.default.defaults.global.maintainAspectRatio=!1,a.chart=new u.default(a.canvas,t)}catch(t){throw new Error("SmartChart.constructor: could not build the chart. Error: "+t)}return a.canvas.style.background="white",a.boxClass="dragbox dragbox-white-boxshadow",a.DEFAULT_BUTTON_ROW_HTML='<div class="col-xs-12 dragbox-row smartchart-buttonrow"><div class="col-xs-10"></div></div>',a.DEFAULT_BUTTON_HTML={closebutton:'<button type="button" class="btn btn-secondary dragbox-button  smartchart-closebutton">Close</button>',savebutton:'<button type="button" class="btn btn-secondary dragbox-button smartchart-savebutton">Save</button>'},a.html(".dragbox-footer",a.DEFAULT_BUTTON_ROW_HTML),a.append(a.DEFAULT_BUTTON_HTML.savebutton,".smartchart-buttonrow","col-xs-1 centered"),a.append(a.DEFAULT_BUTTON_HTML.closebutton,".smartchart-buttonrow","col-xs-1 centered"),a.closeButton=(0,d.default)(a.boxElement).find(".smartchart-closebutton"),a.saveButton=(0,d.default)(a.boxElement).find(".smartchart-savebutton"),a.button=a.closeButton,(0,d.default)(a.closeButton).click(function(){a.callThenDestroy()}),(0,d.default)(a.saveButton).click(function(){a.save()}),a.updatePosition(),a.updateSize(),setTimeout(function(){a.chart.resize(),a.show()},250),a}return a(e,t),l(e,[{key:"callAfterConstructor",value:function(){}},{key:"callThenDestroy",value:function(){this.callback&&this.callback(),void 0!==this.chart&&void 0!==u.default&&this.chart.constructor===u.default&&this.chart.destroy(),this.destroy()}},{key:"save",value:function(){var t=JSON.stringify(this.chartOptions,null,2),e=150+150*this.chartOptions.data.datasets.length;e>500&&(e=500),window.open("data:application/json;"+(window.btoa?"base64,"+btoa(t):t),"SmartChart.save","width=400,height="+e)}}]),e}(c.default);e.default=g},function(t,e,n){"use strict";function o(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0}),e.BindedField=e.BindedProperty=e.SmartChart=e.SmartModal=e.ParamBox=e.DragBox=void 0;var i=n(2),r=o(i),a=n(6),l=o(a),s=n(5),u=o(s),f=n(7),d=o(f),h=n(4),c=o(h),b=n(3),g=o(b),p=n(1);if("undefined"!=typeof window){window.DragBox=r.default,window.ParamBox=l.default,window.SmartModal=u.default,window.SmartChart=d.default,window.BindedProperty=c.default,window.BindedField=g.default;var y="./",v=document.getElementsByTagName("script");if(v.length){y=v[v.length-1].src;var m=(0,p.findAllIndices)("/",y);y=y.substr(0,m[m.length-1])}document.addEventListener("DOMContentLoaded",function(){var t=document.getElementsByTagName("head")[0],e=document.createElement("link");e.rel="stylesheet",e.type="text/css",e.href=y+"/experimentBoxes.css",t.appendChild(e)})}e.DragBox=r.default,e.ParamBox=l.default,e.SmartModal=u.default,e.SmartChart=d.default,e.BindedProperty=c.default,e.BindedField=g.default},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.DEBUG_MODE_ON=!0},function(t,e,n){"use strict";Math.log2=Math.log2||function(t){return Math.log(t)/Math.LN2},Math.log10=Math.log10||function(t){return Math.log(t)/Math.LN10},function(){var e={avg:function(t){for(var e=0,n=0;n<t.length;++n)e+=t[n];return e/t.length},min:function(t){if(0===t.length)return 0;for(var n=t[0],o=1;o<t.length;++o){var i=t[o];Array.isArray(i)&&(i=e.avg(i)),i<n&&(n=i)}return Math.max(0,n)},max:function(t){for(var n=0,o=0;o<t.length;++o){var i=t[o];Array.isArray(i)&&(i=e.avg(i)),i>n&&(n=i)}return Math.max(0,n)},upperMax:function(t){for(var n=0,o=0;o<t.length;++o){var i=t[o];Array.isArray(i)&&(i=e.max(i)),i>n&&(n=i)}return Math.max(0,n)},lowerMin:function(t){if(0===t.length)return 0;var n=t[0]||1/0;Array.isArray(n)&&(n=e.lowerMin(n));for(var o=1;o<t.length;++o){var i=t[o];null!=i&&(Array.isArray(i)&&(i=e.lowerMin(i)),i<n&&(n=i))}return!isNaN(n)&&isFinite(n)||(n=0),Math.max(0,n)},niceNumbers:function(t,e){var n=Math.floor(Math.log10(t)),o=t/Math.pow(10,n);return(e?o<1.5?1:o<3?2:o<7?5:10:o<=1?1:o<=2?2:o<=5?5:10)*Math.pow(10,n)},getLinearTicks:function(t,n,o){var i=e.niceNumbers(n-t,!1),r=e.niceNumbers(i/(o-1),!0);return[Math.floor(t/r)*r,Math.ceil(n/r)*r,r]},getFont:function(t){return t.style=t.style||"normal",t.variant=t.variant||"normal",t.weight=t.weight||"lighter",t.size=t.size||"12",t.family=t.family||"Arial",[t.style,t.variant,t.weight,t.size+"px",t.family].join(" ")},getAxisRatio:function(t,e,n){return(n-t)/(e-t)}},n=function(){function t(t,e){this.mouseListeners=[],this.currentHint=null,this.fillRegions=[],this.options={font:"Helvetica",fontWeight:"normal",fontSizeTitle:24,fontSizeAxes:20,fontSizeTicks:18,fontSizeLabels:18,fontDataTags:18,fontSizeLegend:18,fontSizeHint:18,paddingPercentBars:.1,paddingPercentTicks:.15,paddingPixelsVertical:10,paddingPixelsHorizontal:10,paddingPixelsTicks:10,maxWidthBars:0,fillColorBackground:"rgb(255, 255, 255)",strokeColorBars:"rgb(0, 0, 0)",fillColorBars:"rgba(180, 180, 180, 0.25)",scaleStyle:"linear",barStyle:"none",stackedBarPadding:3,defaultMaxTick:0,pixelsLegendSquare:10,radiusDot:5,fillColorLegend:"rgb(230, 230, 230)",tickFormatter:null,tickFormatterMeasure:null,fillRegion:"normal"},e=e||{};for(var n in this.options)e.hasOwnProperty(n)&&(this.options[n]=e[n]);this.ctx=t,this.content={},this.labelPositions={}}return t.prototype.update=function(t){if("object"!=typeof t)throw new Error("Collections must be objects.");if(!t.hasOwnProperty("labels")||!t.hasOwnProperty("data"))throw new Error("Collection must specify labels and data.");if(!Array.isArray(t.labels)||!Array.isArray(t.data))throw new Error("Labels and data must be arrays.");if(t.labels.length!==t.data.length)throw new Error("Labels and data length must match.");t._data_standard_deviation=[],t._data_standard_error=[];for(var n=0;n<t.data.length;++n){var o=Array.isArray(t.data[n]);if("log2"===this.options.scaleStyle)if(o)for(var i=0;i<t.data[n].length;++i)t.data[n][i]=Math.log2(t.data[n][i]);else t.data[n]=Math.log2(t.data[n]);if(o){for(var r=e.avg(t.data[n]),a=0,l=0;l<t.data[n].length;++l)a+=Math.pow(r-t.data[n][l],2);a=Math.sqrt(a/(t.data[n].length-1)),t._data_standard_deviation.push(a),t._data_standard_error.push(a/Math.sqrt(t.data[n].length))}else t._data_standard_deviation.push(0),t._data_standard_error.push(0)}this.content=t,this.redraw()},t.prototype.redraw=function(){setTimeout(function(){this._draw()}.bind(this),0)},t.prototype.mousemove=function(t,e){for(var n=null,o=0;o<this.mouseListeners.length&&!(n=this.mouseListeners[o](t,e));++o);if(!n||"object"!=typeof n||!n.hasOwnProperty("index")||!n.hasOwnProperty("drawIndex"))return void(null!==this.currentHint&&(this.currentHint=null,this.redraw()));var i=this.currentHint;null!=i&&i.index==n.index&&i.drawIndex==n.drawIndex||(this.currentHint=n,this.redraw())},t.prototype._draw=function(){var t={};this.mouseListeners=[],this.fillRegions=[];var n=this.options,o=this.ctx,i=this.content,r=o.canvas.width,a=o.canvas.height;o.clearRect(0,0,r,a),o.translate(-.5,-.5);var l,s=r,u=a;null!=n.fillColorBackground&&(o.save(),o.fillStyle=n.fillColorBackground,o.fillRect(0,0,r,a),o.restore());var f=n.paddingPixelsHorizontal;u-=n.paddingPixelsHorizontal,o.fillStyle="rgb(0, 0, 0)",null!=i.title&&(o.save(),o.font=e.getFont({weight:n.fontWeight,size:n.fontSizeTitle,family:n.font}),o.textAlign="center",o.fillText(i.title,r/2,f+n.fontSizeTitle),o.restore(),u-=1.25*n.fontSizeTitle,f+=1.25*n.fontSizeTitle);var d=n.paddingPixelsVertical;s-=n.paddingPixelsVertical;var h=null;null!=i.yAxis&&(h=d+.5*n.fontSizeAxes,s-=1.25*n.fontSizeAxes,d+=1.25*n.fontSizeAxes),o.save(),o.font=e.getFont({weight:n.fontWeight,size:n.fontSizeTicks,family:n.font});var c,b;if("stacked"===n.barStyle){c=0,b=1/0;for(var g=0;g<i.data.length;++g){var p;if(Array.isArray(p=i.data[g])){for(var y=0,v=0;v<p.length;++v)y+=p[v];c=Math.max(c,y),b=Math.min(b,y)}else c=Math.max(c,i.data[g]),b=Math.min(b,i.data[g])}}else c=e.upperMax(i.data),b=e.lowerMin(i.data);if(0===n.scaleStyle.indexOf("adaptive")){if(n.scaleStyle.indexOf(":")!==-1){var m=parseFloat(n.scaleStyle.split(/[:]/)[1]);b*=m,c*=1+(1-m)/2}}else b=0;if(n.defaultMaxTick>c&&(c=n.defaultMaxTick),null!=i.bars&&Array.isArray(i.bars))for(l=0;l<i.bars.length;++l){var x=i.bars[l].value;isNaN(x)||(c=Math.max(c,x),b=Math.min(b,x))}var w="log2"==n.scaleStyle?Math.ceil(Math.pow(2,c)):Math.ceil(c)+".00";null!=n.tickFormatterMeasure&&(w=n.tickFormatterMeasure),w=o.measureText(w).width,w=Math.ceil(w)+n.paddingPixelsTicks,s-=w,d+=w,o.restore();n.paddingPixelsVertical;if(s-=n.paddingPixelsVertical,null!=i.legend&&Array.isArray(i.legend)){o.save(),o.font=e.getFont({weight:n.fontWeight,size:n.fontSizeLegend,family:n.font});for(var T=0,S=0;S<i.legend.length;++S)T=Math.max(T,o.measureText(i.legend[S].label).width);T=Math.ceil(T),T+=n.pixelsLegendSquare+8;var k=Math.floor((s-2*n.paddingPixelsHorizontal)/T),_=Math.ceil(i.legend.length/k)*n.fontSizeLegend*1.5;u-=_,B+=_,o.strokeStyle="rgb(0, 0, 0)",o.fillStyle=n.fillColorLegend;var E,M;for(o.beginPath(),o.moveTo(E=d,M=f+u),o.lineTo(E+s,M),o.lineTo(E+s,M+_),o.lineTo(E,M+_),o.lineTo(E,M),o.stroke(),o.fill(),S=0;S<i.legend.length;++S){var A=Math.floor(S/k),P=S%k;o.fillStyle=i.legend[S].color;var L=E+P*T+3,O=M+A*n.fontSizeLegend*1.5+.5*n.fontSizeLegend;o.beginPath(),o.moveTo(L,O),o.lineTo(L+n.pixelsLegendSquare,O),o.lineTo(L+n.pixelsLegendSquare,O+n.pixelsLegendSquare),o.lineTo(L,O+n.pixelsLegendSquare),o.lineTo(L,O),o.fill(),o.stroke(),o.textAlign="left",o.fillStyle="rgb(0, 0, 0)",o.fillText(i.legend[S].label,L+3+n.pixelsLegendSquare,O+.5*n.fontSizeLegend)}o.restore()}var B=n.paddingPixelsHorizontal;u-=n.paddingPixelsHorizontal,null!=i.xAxis&&(o.save(),o.font=e.getFont({weight:n.fontWeight,size:n.fontSizeAxes,family:n.font}),o.fillStyle="rgb(0, 0, 0)",o.textAlign="center",o.fillText(i.xAxis,r-s+s/2,f+u-B),u-=1.5*n.fontSizeAxes,B+=1.5*n.fontSizeAxes,o.restore());var H=s/i.data.length;if(null!=i.topLabels){for(o.save(),o.textAlign="center",o.font=e.getFont({weight:n.fontWeight,size:n.fontSizeLabels,family:n.font}),u-=1.5*n.fontSizeLabels,f+=1.5*n.fontSizeLabels,l=0;l<i.topLabels.length;++l)o.fillText(i.topLabels[l],d+l*H+H/2,f-n.fontSizeLabels/2);o.restore()}o.save();var D=0;if(null!=i.dataTags){o.font=e.getFont({weight:n.fontWeight,size:n.fontDataTags,family:n.font});var z=i.dataTags;for(l=0;l<z.length;++l)if(Array.isArray(z[l]))for(var j=0;j<z[l].length;++j)D=Math.max(D,Math.ceil(o.measureText(z[l][j]).width+5));else D=Math.max(D,Math.ceil(o.measureText(z[l]).width+5))}o.font=e.getFont({weight:n.fontWeight,size:n.fontSizeLabels,family:n.font});var C=Math.floor(H*n.paddingPercentBars/2),I=H-2*C;I<D?(C-=Math.ceil((D-I)/2),C=Math.max(0,C)):n.maxWidthBars>0&&I>n.maxWidthBars&&(C=Math.floor((H-n.maxWidthBars)/2));var R=0,F=1;for(l=0;l<i.labels.length;++l){var N=i.labels[l];if(Array.isArray(N))for(F=Math.max(F,N.length),j=0;j<N.length;++j)R=Math.max(R,o.measureText(N[j]).width);else R=Math.max(R,o.measureText(N).width)}var W=!1;R>H-C?(o.textAlign="right",o.rotate(1.5*Math.PI),W=!0):o.textAlign="center";var U=-n.fontSizeLabels;for(l=0;l<i.labels.length;++l){var Y=i.labels[l],V=d+l*H+H/2,q=f+u-n.fontSizeLabels/2;if(W){if(q=f+u-R+5,(q=[V,V=-q][0])<U+n.fontSizeLabels)continue;U=q}var X=n.fontSizeLabels*(F-1);if(Array.isArray(Y))for(W&&(X=n.fontSizeLabels*(Y.length-1.5),X/=2),j=0;j<Y.length;++j)o.fillText(Y[j],V,q-X),X-=n.fontSizeLabels;else W&&(X=.25*-n.fontSizeLabels),o.fillText(Y,V,q-X)}if(W)u-=R+5,B+=R+5;else{var G=n.fontSizeLabels*F;G+=.5*n.fontSizeLabels,u-=G,B+=G}o.restore();var J=d,Q=d+s,K=f,Z=f+u;for(l=0;l<i.labels.length;++l)t[l]={xStart:d+l*H,xEnd:d+(1+l)*H,yStart:K,yEnd:Z};o.save(),o.strokeStyle="rgb(0, 0, 0)",o.beginPath(),null!=i.topLabels?(o.moveTo(Q,K),o.lineTo(J,K)):o.moveTo(J,K),o.lineTo(J,Z),o.lineTo(Q,Z),null!=i.topLabels&&o.lineTo(d+s,f),o.stroke(),o.restore(),null!=i.topLabel&&(o.save(),o.textAlign="right",o.font=e.getFont({weight:n.fontWeight,size:n.fontSizeLabels,family:n.font}),o.fillText(i.topLabel,d-3,f-n.fontSizeLabels/2),o.restore()),null!=i.yAxis&&(o.save(),o.rotate(1.5*Math.PI),o.font=e.getFont({weight:n.fontWeight,size:n.fontSizeAxes,family:n.font}),o.fillStyle="rgb(0, 0, 0)",o.textAlign="center",o.fillText(i.yAxis,-(f+u/2),h),o.restore()),o.save(),o.fillStyle="rgb(0, 0, 0)",o.strokeStyle="rgba(0, 0, 0, 0.20)",o.font=e.getFont({weight:n.fontWeight,size:n.fontSizeTicks,family:n.font}),o.textAlign="right";var $=e.getLinearTicks(0,c,Math.max(2,u/(n.fontSizeTicks*(1+n.paddingPercentTicks)))),tt=c/n.fontSizeTicks;c=$[1],c+=c>1?Math.ceil(tt):tt;for(var et=[];$[0]<=$[1];)et.push($[0]),$[0]+=$[2];for(l=0;l<et.length;++l){var nt=Math.round(u*e.getAxisRatio(b,c,et[l]));nt<0||("log2"==n.scaleStyle&&0!==et[l]?et[l]=Math.round(Math.pow(2,et[l])):et[l]=Math.floor(100*et[l])/100,null!=n.tickFormatter&&"function"==typeof n.tickFormatter?o.fillText(n.tickFormatter(et[l]).toString(),d-n.paddingPixelsTicks,f+u-nt):o.fillText(et[l].toString(),d-n.paddingPixelsTicks,f+u-nt),0!=l&&(o.beginPath(),o.moveTo(d,f+u-nt),o.lineTo(d+s,f+u-nt),o.stroke()))}if(o.restore(),null!=i.bars&&Array.isArray(i.bars)){for(o.save(),l=0;l<i.bars.length;++l){var ot=i.bars[l];if(!(ot.value>c)){var it=f+u-Math.round(u*e.getAxisRatio(b,c,ot.value));o.strokeStyle=ot.style,o.fillStyle=ot.style,o.beginPath(),o.moveTo(J,it),o.lineTo(Q,it),o.stroke(),o.fill()}}o.restore()}o.save();var rt=null;for(l=0;l<i.data.length;++l){var at=null,lt=null;null!=i.fillColor?Array.isArray(i.fillColor)?at=o.fillStyle=i.fillColor[l]:o.fillStyle=i.fillColor:o.fillStyle=n.fillColorBars,null!=i.strokeColor?Array.isArray(i.strokeColor)?lt=o.strokeStyle=i.strokeColor[l]:o.strokeStyle=i.strokeColor:o.strokeStyle=n.strokeColorBars;var st=i.data[l],ut=Array.isArray(st),ft=d+H*l;if(ut&&"stacked"===n.barStyle){for(var dt=0,ht=0,ct=0;ct<st.length;++ct){null!=at&&Array.isArray(at)&&(o.fillStyle=at[ct]||n.fillColorBars),null!=lt&&Array.isArray(lt)&&(o.strokeStyle=lt[ct]||n.strokeColorBars),dt+=st[ct];var bt=Math.floor(u*e.getAxisRatio(b,c,dt)),gt=f+u-bt;if(Math.abs(bt-ht)<n.stackedBarPadding+2)ht=bt;else{var pt,yt,vt,mt,xt=ct>0?n.stackedBarPadding:0;o.beginPath(),o.moveTo(pt=ft+C,yt=f+u-ht-xt),o.lineTo(ft+C,gt),o.lineTo(vt=ft+(H-1)-C,mt=gt),o.lineTo(ft+(H-1)-C,f+u-ht-xt),ct>0&&o.lineTo(pt,yt),o.stroke(),o.fill();var wt;null!=i.hints&&null!=i.hints[l]&&null!=(wt=i.hints[l][ct])&&this.mouseListeners.push(function(t,e,n,o,i,r,a,l,s){var u=Math.min(o,r),f=Math.max(o,r),d=Math.min(i,a),h=Math.max(i,a);return l<u||l>f||s<d||s>h?null:{index:t,drawIndex:e,rect:{left:u,right:f,top:d,bottom:h},text:n.split("\n")}}.bind(this,l,ct,wt,pt,yt,vt,mt));var Tt;if(yt-gt>1.25*n.fontDataTags&&null!=i.dataTags&&null!=(Tt=i.dataTags[l])&&null!=(Tt=Tt[ct])){var St=o.fillStyle;o.fillStyle="rgb(0, 0, 0)",o.font=e.getFont({weight:n.fontWeight,size:n.fontDataTags,family:n.font}),o.textAlign="center",o.fillText(Tt,ft+H/2,yt-.25*n.fontDataTags),o.fillStyle=St}ht=bt}}null!=i.barTooltips&&(o.fillStyle="rgb(0, 0, 0)",o.font=e.getFont({weight:n.fontWeight,size:n.fontSizeLabels,family:n.font}),o.textAlign="center",o.fillText(i.barTooltips[l]||"",ft+H/2,gt-3))}else if("line"===n.barStyle){if(ut){var kt,_t=ft+H/2;if("background"===n.fillRegion&&(kt=rt,Array.isArray(kt)&&(kt=kt[0]),null!=kt)){var Et=o.fillStyle;o.fillStyle=kt.color,o.fillRect(kt.x,K,_t-kt.x,Z-K),o.fillStyle=Et}for(var Mt=[],ct=0;ct<st.length;++ct){var At=Math.round(u*e.getAxisRatio(b,c,st[ct])),Pt=f+u-At,Lt=Pt;if(null!=rt){var Ot,Bt;Array.isArray(rt)?(Ot=(rt[ct]||{}).x,Bt=(rt[ct]||{}).y):(Ot=rt.x,Bt=rt.y),Ot&&Bt&&(Array.isArray(lt)?o.strokeStyle=lt[ct]||n.strokeColorBars:o.strokeStyle=lt||"rgb(0, 0, 0)",o.beginPath(),o.moveTo(Ot,Bt),o.lineTo(_t,Lt),o.stroke())}Array.isArray(at)&&(o.fillStyle=at[ct]||n.fillColorBars),Array.isArray(lt)&&(o.strokeStyle=lt[ct]||n.strokeColorBars),o.beginPath(),o.arc(_t,Lt,n.radiusDot,0,2*Math.PI),o.stroke(),o.fill(),Mt[ct]={x:_t,y:Lt,color:o.fillStyle}}if(rt=Mt,null!=kt&&kt.color!=rt[0].color&&this.fillRegions.push({x:rt[0].x,y:rt[0].y,prev:kt.color,next:rt[0].color}),null!=i.balls&&Array.isArray(i.balls)&&l<i.balls.length){var Ht=i.balls[l];null!=Ht&&(o.beginPath(),o.fillStyle=Ht.fill,o.strokeStyle=Ht.stroke,o.arc(_t,f+u-u*e.getAxisRatio(b,c,b+Ht.value),Ht.radius,0,2*Math.PI),o.stroke(),o.fill())}}else{var kt,At=Math.round(u*e.getAxisRatio(b,c,st)),Pt=f+u-At,_t=ft+H/2,Lt=Pt;if("background"===n.fillRegion&&null!=rt){kt=rt,Array.isArray(kt)&&(kt=kt[0]);var Et=o.fillStyle;o.fillStyle=kt.color,o.fillRect(kt.x,K,_t-kt.x,Z-K),o.fillStyle=Et}if(o.beginPath(),o.arc(_t,Lt,n.radiusDot,0,2*Math.PI),o.stroke(),o.fill(),null!=rt)if(Array.isArray(rt)){var Ot,Bt;for(var Dt in rt)rt.hasOwnProperty(Dt)&&(Ot=rt[Dt].x,Bt=rt[Dt].y,Ot&&Bt&&(o.strokeStyle=lt||"rgb(0, 0, 0)",o.beginPath(),o.moveTo(Ot,Bt),o.lineTo(_t,Lt),o.stroke()))}else{var Ot=rt.x,Bt=rt.y;Ot&&Bt&&(o.strokeStyle=lt||"rgb(0, 0, 0)",o.beginPath(),o.moveTo(Ot,Bt),o.lineTo(_t,Lt),o.stroke())}if(rt={x:_t,y:Lt,color:o.fillStyle},null!=kt&&kt.color!=rt.color&&this.fillRegions.push({x:rt.x,y:rt.y,prev:kt.color,next:rt.color}),null!=i.balls&&Array.isArray(i.balls)&&l<i.balls.length){var Ht=i.balls[l];null!=Ht&&(o.beginPath(),o.fillStyle=Ht.fill,o.strokeStyle=Ht.stroke,o.arc(_t,f+u-u*e.getAxisRatio(b,c,b+Ht.value),Ht.radius,0,2*Math.PI),o.stroke(),o.fill())}}var wt;null!=i.hints&&null!=(wt=i.hints[l])&&this.mouseListeners.push(function(t,e,n,o,i,r,a,l){var s=Math.min(n,i),u=Math.max(n,i),f=Math.min(o,r),d=Math.max(o,r);return a<s||a>u||l<f||l>d?null:{index:t,drawIndex:ct,rect:{left:s,right:u,top:f,bottom:d},text:e.split("\n")}}.bind(this,l,wt,_t-1,f,_t+1,f+u))}else{ut&&(st=e.avg(st));var zt=Math.round(u*e.getAxisRatio(b,c,st)),jt=f+u-zt;if(o.beginPath(),o.moveTo(ft+C,f+u),o.lineTo(ft+C,jt),o.lineTo(ft+(H-1)-C,jt),o.lineTo(ft+(H-1)-C,f+u),o.stroke(),o.fill(),"error"===n.barStyle){var Ct;if(0!=(Ct=i._data_standard_error[l])){var It=Math.round(u*e.getAxisRatio(b,c,Ct));o.beginPath();var Rt=Math.round((H-2*C)/8),Ft=d+H*l+H/2;o.moveTo(Ft-Rt,jt+It),o.lineTo(Ft+Rt,jt+It),o.moveTo(Ft,jt+It),o.lineTo(Ft,jt-It),o.moveTo(Ft-Rt,jt-It),o.lineTo(Ft+Rt,jt-It),o.stroke()}}null!=i.barTooltips&&(o.fillStyle="rgb(0, 0, 0)",o.font=e.getFont({weight:n.fontWeight,size:n.fontSizeLabels,family:n.font}),o.textAlign="center",o.fillText(i.barTooltips[l]||"",ft+H/2,jt-3))}}if(o.restore(),null!=this.currentHint){o.save();var Nt=this.currentHint.rect,Wt=this.currentHint.text;o.fillStyle="rgb(0, 0, 0)",o.font=e.getFont({weight:n.fontWeight,size:n.fontSizeHint,family:n.font}),o.textAlign="left";var Ut=0;for(l=0;l<Wt.length;++l)Ut=Math.max(Ut,Math.ceil(o.measureText(Wt[l]).width));var Yt=1.5*n.fontSizeHint,Vt=Wt.length*Yt,qt=Nt.right+10,Xt=(Nt.top+Nt.bottom)/2;for(Ut+=10,qt+Ut>r&&(qt=Nt.left-Ut-10),Xt-Vt/2<0?Xt=Math.ceil(Vt/2)+1:Xt+Vt/2>a&&(Xt=a-Vt/2-1),o.clearRect(qt,Xt-Vt/2,Ut,Vt),o.beginPath(),o.rect(qt,Xt-Vt/2,Ut,Vt),o.stroke(),l=0;l<Wt.length;++l)o.fillText(Wt[l],qt+5,Xt-Vt/2+n.fontSizeHint+l*Yt);o.restore()}o.translate(.5,.5),this.labelPositions=t},t}();void 0!==t&&void 0!==t.exports?t.exports=n:window.BarChart=n}()},function(t,e){var n;n=function(){return this}();try{n=n||Function("return this")()||(0,eval)("this")}catch(t){"object"==typeof window&&(n=window)}t.exports=n},function(t,n){t.exports=e},function(t,e){t.exports=n}])});